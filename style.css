/* ---------- Layout ---------- */
html, body { height: 100%; margin: 0; }
#map { height: 100%; width: 100%; }

/* ---------- Design tokens ---------- */
:root {
  --ui-bg: #fff;
  --ui-border: #ddd;
  --ui-border-strong: #bbb;
  --ui-shadow: 0 2px 10px rgba(0,0,0,.12);
  --ui-radius: 14px;
  --ui-pad: 10px;
  --ui-gap: 8px;

  --pd-stroke: #ff6600;
  --pd-selected: #d40000;
  --zone-stroke: #2166f3;
  --zone-selected: #0b3aa5;

  --btn-bg: #fff;
  --btn-bg-ghost: #f7f7f7;
  --btn-border: #bbb;
  --btn-hover: #f0f0f0;
}

/* ---------- Unified card shell (PD, Zones, Trip, Report) ---------- */
.pd-control,
.routing-control,
.report-control {
  background: var(--ui-bg);
  padding: var(--ui-pad);
  box-shadow: var(--ui-shadow);
  border-radius: var(--ui-radius);
  font: 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  width: 250px;
  max-width: 250px;
}

/* Titles on top (like your “old format”) */
.pd-header,
.routing-header {
  display: block;
  margin-bottom: 6px;
}
.pd-header strong,
.routing-header strong {
  display: block;
  font-weight: 800;
  font-size: 20px;
  margin: 0 0 8px 0;
}

/* Action rows under the title */
.pd-actions,
.routing-actions {
  display: flex;
  align-items: center;
  gap: var(--ui-gap);
  flex-wrap: wrap;
}

/* ---------- Buttons & inputs ---------- */
.pd-control button,
.routing-control button,
.report-control button {
  appearance: none;
  background: var(--btn-bg);
  border: 1px solid var(--btn-border);
  border-radius: 12px;
  padding: 7px 12px;
  cursor: pointer;
  font: inherit;
}
.pd-control button:hover,
.routing-control button:hover,
.report-control button:hover { background: var(--btn-hover); }
.pd-control button.active,
.routing-control button.active { border-color: #888; box-shadow: inset 0 0 0 1px #888; }
button.ghost { background: var(--btn-bg-ghost); }

.pd-control input[type="text"],
.routing-control input[type="text"] {
  width: 100%;
  padding: 7px 9px;
  border: 1px solid var(--ui-border);
  border-radius: 8px;
  font: inherit;
  box-sizing: border-box;
}

/* ---------- PD list ---------- */
.pd-list {
  display: grid;
  grid-template-columns: 1fr;
  gap: 4px;
  max-height: 300px;
  overflow: auto;
  padding: 2px;
  border-top: 1px dashed var(--ui-border);
  margin-top: 6px;
}
.pd-item { display: flex; align-items: center; gap: 8px; padding: 4px 2px; border-radius: 4px; }
.pd-item:hover { background: rgba(0,0,0,.03); }
.pd-cbx { flex: 0 0 auto; margin: 0 2px 0 0; width: 14px; height: 14px; }
.pd-name { cursor: pointer; flex: 1; user-select: none; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.pd-item.selected .pd-name { font-weight: 600; }

/* ---------- PD selected label (center pin) ---------- */
.pd-label .leaflet-tooltip {
  background: rgba(255, 255, 255, 0.95);
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  box-shadow: var(--ui-shadow);
  color: #000;
  font-weight: 600;
  padding: 4px 8px;
}

/* ---------- Zones (chips, popup) ---------- */
.zone-label { }
.zone-tag {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 999px;
  border: 1px solid var(--zone-stroke);
  background: #fff;
  font-weight: 600;
  font-size: 12px;
  line-height: 1.1;
  box-shadow: var(--ui-shadow);
  user-select: none;
}
.zone-popup .leaflet-popup-content { font: 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

/* ---------- Zones control inline search ---------- */
.pz-inline-search {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--ui-border);
  border-radius: 6px;
  font: inherit;
  box-sizing: border-box;
}

/* ---------- Routing control (Trip Generator & Keys) ---------- */
.routing-control .routing-section + .routing-section {
  border-top: 1px dashed var(--ui-border);
  margin-top: 10px;
  padding-top: 10px;
}
.routing-row { display: flex; gap: var(--ui-gap); align-items: center; flex-wrap: wrap; margin-top: 8px; }
.routing-hint { color: #666; font-size: 12.5px; margin-top: 4px; display: block; }

/* Key manager sub-section */
.key-row { display: grid; grid-template-columns: 1fr; gap: 8px; }
#txt-ors-keys { font-family: ui-monospace, Menlo, Consolas, "Liberation Mono", monospace; }

/* ---------- Leaflet tweaks ---------- */
.leaflet-popup-content { margin: 8px 10px; }
.leaflet-popup-content-wrapper { border-radius: 10px; }

/* ---------- Top geocoder (match 250px) ---------- */
.leaflet-control-geocoder { width: 250px; max-width: 250px; }
.leaflet-control-geocoder-form input { font-size: 16px; padding: 8px 10px; height: 38px; }

/* ====== compact headers ====== */
.pd-header strong,
.routing-header strong {
  font-size: 16px;     /* down from 20–24 */
  line-height: 1.2;
  margin: 0 0 6px 0;
  font-weight: 700;
}

/* ====== put actions on ONE row ====== */
.pd-actions,
.routing-actions {
  display: flex;
  gap: 6px;            /* tighter gap so 3 items fit */
  flex-wrap: nowrap;   /* no wrapping */
  align-items: center;
}

/* Compact buttons to prevent wrapping */
.pd-control button,
.routing-control button,
.report-control button {
  font-size: 13px;
  padding: 5px 9px;
  white-space: nowrap; /* keep labels on one line */
}

/* In the PD header you have 3 items: Select all / Clear all / Expand.
   Make them share the row cleanly inside 250px. */
.pd-header .pd-actions > button {
  flex: 1 1 0;         /* 3 equal buttons */
  min-width: 0;        /* allow shrinking */
}

/* Zones row: Engage / Disengage / Zone # in one line at 250px */
.pd-header .pd-actions #pz-engage,
.pd-header .pd-actions #pz-disengage {
  flex: 0 0 auto;      /* keep natural width */
}
.pd-header .pd-actions #pz-inline-search {
  flex: 1 1 auto;      /* let the input take remaining space */
  min-width: 80px;     /* still small enough to fit */
  max-width: 100%;
  margin-left: 4px;
  font-size: 13px;
  padding: 6px 8px;
}

/* Keep card + geocoder widths at 250px */
.leaflet-control-geocoder { width: 250px; max-width: 250px; }
.leaflet-control-geocoder-form input { height: 36px; font-size: 15px; }

.pd-control, .routing-control, .report-control {
  width: 250px !important;
  max-width: 250px !important;
}
